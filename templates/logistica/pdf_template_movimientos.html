<!DOCTYPE html>
<html>
<head>
    <style>
        @page {
            size: A4 landscape;
            margin: 1cm; /* Un margen un poco más amplio es mejor para impresión */
        }

        body { 
            font-family: Helvetica, sans-serif; 
            font-size: 10px; 
            margin: 0;
        }

        .titulo { text-align: center; font-size: 16px; font-weight: bold; margin-bottom: 15px; }
        
        table { 
            width: 100%; /* ESTE ES EL CAMBIO CLAVE */
            border-collapse: collapse; 
            table-layout: fixed; /* Recomendado para PDF para controlar anchos */
        }
        
        th, td { 
            border: 0.5px solid #000; 
            padding: 5px; 
            text-align: left; 
            font-size: 9px; 
            word-wrap: break-word; /* Evita que textos largos rompan la tabla */
        }

        th { background-color: #f2f2f2; }

        /* Definimos porcentajes que sumen 100% para cubrir todo el ancho */
        .col-art { width: 15%; }
        .col-tipo { width: 10%; }
        .col-orig { width: 17%; }
        .col-dest { width: 17%; }
        .col-cant { width: 7%; }
        .col-ref { width: 13%; }
        .col-obs { width: 20%; } /* Ahora sí cabrá en la hoja */

        .firma-box { margin-top: 30px; text-align: center; width: 250px; }
        .firma-img { width: 200px; height: auto; border-bottom: 1px solid #000; }
    </style>
</head>
<body>
    <div class="titulo">ACTA DE MOVIMIENTOS #{{ cabecera.id_cabezera }}</div>
    
    <p><strong>Colaborador:</strong> {{ cabecera.colaborador_confirma.nombre_colaborador }}</p>
    <p><strong>Fecha:</strong> {{ cabecera.fecha|date:"d/m/Y H:i" }}</p>

    <table>
        <thead>
            <tr>
                <th class="col-art">Articulo</th>
                <th class="col-tipo">TipMovimiento</th>
                <th class="col-orig">Origen</th>
                <th class="col-dest">Destino</th>
                <th class="col-cant">Cantidad</th>
                <th class="col-ref">MovReferencia</th>
                <th class="col-obs">Observaciones</th>
            </tr>
        </thead>
        <tbody>
            {% for movimiento in movimientos %}
            <tr>
                <td>{{ movimiento.id_item.nombre_item }}</td>
                <td>{{ movimiento.tipo_movimiento.nombre_movimiento }}</td>
                <td>{{ movimiento.nombre_origen }}</td>
                <td>{{ movimiento.nombre_destino }}</td>
                <td>{{ movimiento.cantidad_movimiento }}</td>
                <td>{{ movimiento.id_movimiento_referencia|default:"Sin Referencia" }}</td>                
                <td>{{ movimiento.observaciones|default:"Sin Observaciones" }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="firma-box">
        <img src="{{ cabecera.firma_base64 }}" class="firma-img">
        <p>Firma del Colaborador</p>
        <p><small>HASH: {{ cabecera.hash_seguridad }}</small></p>
    </div>
</body>
</html>